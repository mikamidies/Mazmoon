<template>
  <div class="wrap">
    <div class="container">
      <h4 class="title">
        <span>{{ $store.state.translations["new.about-span"] }}</span>
        {{ $store.state.translations["new.about-title"] }}
      </h4>
      <div class="grid">
        <div class="left">
          <ul>
            <li>
              <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 26 26" fill="none">
                <g clip-path="url(#clip0_1918_7564)">
                  <rect width="26" height="26" rx="13" fill="url(#paint0_linear_1918_7564)" />
                  <path fill-rule="evenodd" clip-rule="evenodd"
                    d="M6.60628 13.953C6.30407 13.6564 5.81987 13.6389 5.49625 13.9129L-0.512578 19L-3 14.1891L3.00883 9.10191C4.84267 7.54936 7.58646 7.64851 9.299 9.32918L12.423 12.3951C12.7417 12.7078 13.2583 12.7078 13.577 12.3951L16.701 9.32918C18.4135 7.64851 21.1573 7.54937 22.9912 9.10191L29 14.1891L26.5126 19L20.5037 13.9129C20.1801 13.6389 19.6959 13.6564 19.3937 13.953L16.2697 17.0188C14.4639 18.7911 11.5361 18.7911 9.73027 17.0188L6.60628 13.953Z"
                    fill="white" />
                </g>
                <defs>
                  <linearGradient id="paint0_linear_1918_7564" x1="-3.26642e-07" y1="-12.1875" x2="36.8703" y2="-2.19579"
                    gradientUnits="userSpaceOnUse">
                    <stop stop-color="#3C4BDC" />
                    <stop offset="1" stop-color="#7B7DFF" />
                  </linearGradient>
                  <clipPath id="clip0_1918_7564">
                    <rect width="26" height="26" rx="13" fill="white" />
                  </clipPath>
                </defs>
              </svg>
              <p class="sub">
                {{ $store.state.translations["new.list-1"] }}
              </p>
            </li>
            <li>
              <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 26 26" fill="none">
                <g clip-path="url(#clip0_1918_7564)">
                  <rect width="26" height="26" rx="13" fill="url(#paint0_linear_1918_7564)" />
                  <path fill-rule="evenodd" clip-rule="evenodd"
                    d="M6.60628 13.953C6.30407 13.6564 5.81987 13.6389 5.49625 13.9129L-0.512578 19L-3 14.1891L3.00883 9.10191C4.84267 7.54936 7.58646 7.64851 9.299 9.32918L12.423 12.3951C12.7417 12.7078 13.2583 12.7078 13.577 12.3951L16.701 9.32918C18.4135 7.64851 21.1573 7.54937 22.9912 9.10191L29 14.1891L26.5126 19L20.5037 13.9129C20.1801 13.6389 19.6959 13.6564 19.3937 13.953L16.2697 17.0188C14.4639 18.7911 11.5361 18.7911 9.73027 17.0188L6.60628 13.953Z"
                    fill="white" />
                </g>
                <defs>
                  <linearGradient id="paint0_linear_1918_7564" x1="-3.26642e-07" y1="-12.1875" x2="36.8703" y2="-2.19579"
                    gradientUnits="userSpaceOnUse">
                    <stop stop-color="#3C4BDC" />
                    <stop offset="1" stop-color="#7B7DFF" />
                  </linearGradient>
                  <clipPath id="clip0_1918_7564">
                    <rect width="26" height="26" rx="13" fill="white" />
                  </clipPath>
                </defs>
              </svg>
              <p class="sub">
                {{ $store.state.translations["new.list-2"] }}
              </p>
            </li>
            <li>
              <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 26 26" fill="none">
                <g clip-path="url(#clip0_1918_7564)">
                  <rect width="26" height="26" rx="13" fill="url(#paint0_linear_1918_7564)" />
                  <path fill-rule="evenodd" clip-rule="evenodd"
                    d="M6.60628 13.953C6.30407 13.6564 5.81987 13.6389 5.49625 13.9129L-0.512578 19L-3 14.1891L3.00883 9.10191C4.84267 7.54936 7.58646 7.64851 9.299 9.32918L12.423 12.3951C12.7417 12.7078 13.2583 12.7078 13.577 12.3951L16.701 9.32918C18.4135 7.64851 21.1573 7.54937 22.9912 9.10191L29 14.1891L26.5126 19L20.5037 13.9129C20.1801 13.6389 19.6959 13.6564 19.3937 13.953L16.2697 17.0188C14.4639 18.7911 11.5361 18.7911 9.73027 17.0188L6.60628 13.953Z"
                    fill="white" />
                </g>
                <defs>
                  <linearGradient id="paint0_linear_1918_7564" x1="-3.26642e-07" y1="-12.1875" x2="36.8703" y2="-2.19579"
                    gradientUnits="userSpaceOnUse">
                    <stop stop-color="#3C4BDC" />
                    <stop offset="1" stop-color="#7B7DFF" />
                  </linearGradient>
                  <clipPath id="clip0_1918_7564">
                    <rect width="26" height="26" rx="13" fill="white" />
                  </clipPath>
                </defs>
              </svg>
              <p class="sub">
                {{ $store.state.translations["new.list-3"] }}
              </p>
            </li>
            <li>
              <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 26 26" fill="none">
                <g clip-path="url(#clip0_1918_7564)">
                  <rect width="26" height="26" rx="13" fill="url(#paint0_linear_1918_7564)" />
                  <path fill-rule="evenodd" clip-rule="evenodd"
                    d="M6.60628 13.953C6.30407 13.6564 5.81987 13.6389 5.49625 13.9129L-0.512578 19L-3 14.1891L3.00883 9.10191C4.84267 7.54936 7.58646 7.64851 9.299 9.32918L12.423 12.3951C12.7417 12.7078 13.2583 12.7078 13.577 12.3951L16.701 9.32918C18.4135 7.64851 21.1573 7.54937 22.9912 9.10191L29 14.1891L26.5126 19L20.5037 13.9129C20.1801 13.6389 19.6959 13.6564 19.3937 13.953L16.2697 17.0188C14.4639 18.7911 11.5361 18.7911 9.73027 17.0188L6.60628 13.953Z"
                    fill="white" />
                </g>
                <defs>
                  <linearGradient id="paint0_linear_1918_7564" x1="-3.26642e-07" y1="-12.1875" x2="36.8703" y2="-2.19579"
                    gradientUnits="userSpaceOnUse">
                    <stop stop-color="#3C4BDC" />
                    <stop offset="1" stop-color="#7B7DFF" />
                  </linearGradient>
                  <clipPath id="clip0_1918_7564">
                    <rect width="26" height="26" rx="13" fill="white" />
                  </clipPath>
                </defs>
              </svg>
              <p class="sub">
                {{ $store.state.translations["new.list-4"] }}
              </p>
            </li>
          </ul>
          <button @click="modalHandle = true">
            {{ $store.state.translations["main.send-app"] }}
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
              <g clip-path="url(#clip0_1844_7465)">
                <path
                  d="M1.66602 18.3332L10.0554 9.94372M14.9237 9.71068C15.3402 9.71068 15.7377 9.52412 15.9816 9.18645C17.1931 7.50883 18.0157 5.53175 18.3171 3.38742C18.4585 2.3817 17.6169 1.54067 16.6112 1.68209C10.8711 2.48926 6.32962 7.03072 5.52246 12.7708C5.38104 13.7765 6.22206 14.6182 7.22778 14.4768C9.37211 14.1754 11.3492 13.3528 13.0268 12.1413C13.3645 11.8974 13.551 11.4999 13.551 11.0833C13.551 10.3252 14.1656 9.71068 14.9237 9.71068Z"
                  stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
              </g>
              <defs>
                <clipPath id="clip0_1844_7465">
                  <rect width="20" height="20" fill="white" />
                </clipPath>
              </defs>
            </svg>
          </button>
        </div>
        <div class="right">
          <img src="@/assets/img/about.png" alt="" class="pic" />
        </div>
      </div>
    </div>

    <div class="wrep modal" :class="{ show: modalHandle == true }">
      <div class="x" @click="modalHandle = false">
        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48" fill="none">
          <path d="M32.4862 15.5148L15.5156 32.4853M32.4862 32.4852L15.5156 15.5146" stroke="#28303F" stroke-width="2"
            stroke-linecap="round" stroke-linejoin="round" />
        </svg>
      </div>
      <div class="cont small">
        <h4 class="tite">
          {{ $store.state.translations["main.modal-title"] }}
        </h4>
        <p class="sub">
          {{ $store.state.translations["main.modal-sub"] }}
        </p>
        <form @submit.prevent="onSubmit">
          <div class="type">
            <p class="top">
              {{ $store.state.translations["main.project-type"] }}
            </p>
            <div class="items buttons">
              <button @click="type = 'web'" :class="{ active: type == 'web' }" type="button">
                {{ $store.state.translations["main.type-1"] }}
              </button>
              <button @click="type = 'corp'" :class="{ active: type == 'corp' }" type="button">
                {{ $store.state.translations["main.type-2"] }}
              </button>
              <button @click="type = 'crm'" :class="{ active: type == 'crm' }" type="button">
                {{ $store.state.translations["main.type-3"] }}
              </button>
              <button @click="type = 'mobil'" :class="{ active: type == 'mobil' }" type="button">
                {{ $store.state.translations["main.type-4"] }}
              </button>
              <button @click="type = 'lending'" :class="{ active: type == 'lending' }" type="button">
                {{ $store.state.translations["main.type-5"] }}
              </button>
              <button @click="type = 'e-shop'" :class="{ active: type == 'e-shop' }" type="button">
                {{ $store.state.translations["main.type-6"] }}
              </button>
            </div>
          </div>
          <div class="budget">
            <p class="top">
              {{ $store.state.translations["main.project-budget"] }}
            </p>
            <div class="items buttons">
              <button @click="price = 4000000" :class="{ active: price == 4000000 }" type="button">
                {{ $store.state.translations["main.budget-1"] }}
              </button>
              <button @click="price = 12000000" :class="{ active: price == 12000000 }" type="button">
                {{ $store.state.translations["main.budget-2"] }}
              </button>
              <button @click="price = 18000000" :class="{ active: price == 18000000 }" type="button">
                {{ $store.state.translations["main.budget-3"] }}
              </button>
              <button @click="price = 20000000" :class="{ active: price == 20000000 }" type="button">
                {{ $store.state.translations["main.budget-4"] }}
              </button>
              <button @click="price = 26000000" :class="{ active: price == 26000000 }" type="button">
                {{ $store.state.translations["main.budget-5"] }}
              </button>
              <button @click="price = NaN" :class="{ active: price == NaN }" type="button">
                {{ $store.state.translations["main.budget-6"] }}
              </button>
            </div>
          </div>
          <div class="form">
            <p class="top">
              {{ $store.state.translations["main.form-title"] }}
            </p>
            <div class="inputs">
              <input v-model="full_name" required type="text" :placeholder="$store.state.translations['main.your-name']"
                minlength="3" />
              <input v-mask="'+998 (##) ###-##-##'" v-model="number" required type="text"
                :placeholder="$store.state.translations['main.your-phone']" ref="maskedInput"
                @input="checkMaskValidity" />
              <textarea v-model="message" :placeholder="$store.state.translations['main.your-comment']"></textarea>
            </div>
          </div>
          <div class="butn">
            <button type="submit" class="submit">
              <span class="logo">
                <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48" fill="none">
                  <path
                    d="M4 44L24.1346 23.8653M35.8184 23.306C36.818 23.306 37.7721 22.8583 38.3574 22.0479C41.265 18.0216 43.2392 13.2766 43.9626 8.13019C44.3019 5.71647 42.2821 3.698 39.8684 4.03741C26.0921 5.97461 15.1927 16.8741 13.2555 30.6504C12.916 33.0641 14.9345 35.084 17.3482 34.7447C22.4946 34.0212 27.2396 32.0471 31.2659 29.1394C32.0763 28.5542 32.524 27.6 32.524 26.6004C32.524 24.781 33.999 23.306 35.8184 23.306Z"
                    stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
              </span>
              {{ $store.state.translations["main.send-app"] }}
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</template>

<script>
import formApi from "@/api/form.js";

export default {
  data() {
    return {
      delay: 1000,
      endVal: 400,
      endVal2: 67,
      options: {
        useEasing: true,
        enableScrollSpy: true,
        scrollSpyDelay: 100,
        scrollSpyOnce: true,
      },

      modalHandle: false,
      type: "",
      price: "",
      full_name: "",
      number: "",
      message: "",

      token: "6634150070:AAEKuBPXKTxnw47yxkMt1TLQ-ZxBQPOPqvc",
      chatId: "-1001823370666",
    };
  },

  watch: {
    modalHandle(val) {
      if (val) {
        document.body.style.overflow = "hidden";
        document.body.style.height = "100vh";
      } else {
        document.body.style.overflow = "auto";
        document.body.style.height = "auto";
      }
    },
  },

  methods: {
    checkMaskValidity() {
      const inputElement = this.$refs.maskedInput;

      const inputValue = inputElement.value;

      const isValid = inputValue.length >= 19;

      inputElement.setCustomValidity(isValid ? '' : 'Заполните поле правильно.');
    },

    async onSubmit() {
      const formData = {
        type: this.type,
        price: this.price,
        full_name: this.full_name,
        number: this.number,
        message: this.message,
      };

      if (this.number.length > 1) {
        const res = await formApi.sendApplication(formData);

        if (res && res.status === 201) {
          this.$toast.success("Successfully sent");
        } else {
          this.$toast.error("Error");
        }

        const message = `Name: ${this.full_name}%0APhone Number: ${this.number}%0AMessage: ${this.message}%0AType: ${this.type}%0APrice: ${this.price}`;

        this.$axios
          .post(
            `https://api.telegram.org/bot${this.token}/sendMessage?chat_id=${this.chatId}&text=${message}`
          )
          .then((response) => {
            console.log("Successfully", response);

            this.type = "";
            this.price = "";
            this.full_name = "";
            this.number = "";
            this.message = "";
          });

        this.modalHandle = false;
      }
    },
  },
};
</script>

<style scoped>
@import url(@/assets/css/modal.css);

.wrap {
  padding-bottom: 120px;
}

.grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  align-items: center;
  gap: 64px;
  border-radius: 40px;
  background: var(--Apple-Grey, #f5f5f7);
  padding: 54px 48px;
  position: relative;
}

.title {
  margin-bottom: 24px;
  color: var(--Black, #c2c2c3);
  font-family: var(--bold);
  font-size: 60px;
  font-style: normal;
  font-weight: 800;
  line-height: 120%;
  /* 76.8px */
  max-width: 700px;
}

.title span {
  color: black;
}

ul {
  display: flex;
  flex-direction: column;
  gap: 24px;
  max-width: 500px;
}

li {
  display: grid;
  grid-template-columns: 0.7fr 9.3fr;
  align-items: flex-start;
}

li p {
  color: var(--Black, #292929);
  font-family: var(--medium);
  font-size: 24px;
  font-style: normal;
  font-weight: 500;
  line-height: 140%;
  /* 33.6px */
}

li svg {
  transform: translateY(5px);
}

button {
  border-radius: 62px;
  background: var(--Linear,
      linear-gradient(105deg, #3c4bdc -9.99%, #7b7dff 109.77%));
  color: var(--White, #fff);
  font-size: 16px;
  font-style: normal;
  font-weight: 500;
  line-height: 150%;
  /* 24px */
  padding: 16px 40px;
  border: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  margin-top: 40px;
}

.pic {
  width: 60%;
  height: 600px;
  object-fit: contain;
  position: absolute;
  top: -100px;
  right: -50px;
}

@media screen and (max-width: 1024px) {
  .wrap {
    padding-bottom: 80px;
  }

  .title {
    font-size: 30px;
    font-style: normal;
    font-weight: 700;
    line-height: 120%;
    max-width: 90%;
  }

  .pic {
    position: static;
    transform: unset;
    height: 300px;
    width: 100%;
    margin: 0 0 -120px 0;
  }

  li {
    grid-template-columns: 1.2fr 8.8fr;
  }

  .grid {
    border-radius: 16px;
    padding: 24px;
    display: flex;
    flex-direction: column;
    gap: 24px;
  }

  li p {
    font-size: 20px;
    font-style: normal;
    font-weight: 500;
    line-height: 150%;
  }

  .left button {
    width: 100%;
    margin-top: 40px;
  }

  button {
    width: initial;
    margin: 0;
  }
}
</style>
